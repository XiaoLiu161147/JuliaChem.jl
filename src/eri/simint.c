//--uses minimal algorithm for SIMGMS implementation--//

#include <stdio.h>
#include <stdbool.h>
#include <unistd.h>
#include <assert.h>

#include "simint.h"

static double* work = NULL; //shared workspace for SIMINT ERI computations
static struct simint_shell* shells = NULL; //array of basis set shells for SIMINT
static double* sp_shell = NULL; //array telling if given shell is L shell or not

struct simint_multi_shellpair left_pair; //bra SIMINT shell pair structure
struct simint_multi_shellpair right_pair; //ket SIMINT shell pair structure

int iold, jold; 
int nshells, ishell;
int nshell_simint; 

//---------------------//
//--initialize SIMINT--//
//---------------------//
void initialize_c() 
{
    printf("Initializing SIMINT\n");

    simint_init();

    simint_initialize_multi_shellpair(&left_pair);
    simint_initialize_multi_shellpair(&right_pair);

    iold = -1; jold = -1; ishell = 0;
}

//-------------------//
//--SIMINT clean-up--//
//-------------------//
void finalize_c() 
{
    printf("Finalizing SIMINT\n");

    //--Free remaining memory--//
    SIMINT_FREE(work);
    free(sp_shell);

    for (int i = 0; i != nshell_simint; ++i) simint_free_shell(&shells[i]);
    free(shells);

    simint_free_multi_shellpair(&right_pair);
    simint_free_multi_shellpair(&left_pair);

    //--Finalize the SIMINT library--//
    simint_finalize();
}
//--------------------------------//
//--Get info on basis set shells--//
//--------------------------------//
void get_julia_shell_info_c(struct shell* p_input) 
{
  struct shell input = (*p_input);

  printf("ATOM ID: %lld\n", input.atom_id);
  printf("ATOM AM: %lld\n", input.am);
  printf("ATOM NBAS: %lld\n", input.nbas);
  printf("ATOM NPRIM: %lld\n", input.nprim);
  printf("ATOM POS: %lld\n", input.pos);

  printf("ATOM EXPONENTS:\n");
  for (int i = 0; i != input.nprim; ++i) { 
    printf("%f\n",input.exponents[i]);
  }
  printf("\n");

  int coeff_count = input.nbas == 4 ? 2*input.nprim : input.nprim;
  printf("ATOM COEFFICIENTS:\n");
  for (int i = 0; i != coeff_count; ++i) { 
    printf("%f\n",input.coefficients[i]);
  }
  printf("\n");
}

void get_simint_shell_info_c(long long int shell_num) 
{
  struct simint_shell input = shells[shell_num];

  printf("ATOM AM: %lld\n", input.am);
  printf("ATOM NPRIM: %lld\n", input.nprim);
  printf("ATOM POS: %lld\n", shell_num);

  printf("ATOM COORD: %f, %f, %f\n:", input.x, input.y, input.z);

  printf("ATOM EXPONENTS:\n");
  for (int i = 0; i != input.nprim; ++i) { 
    printf("%f\n",input.alpha[i]);
  }
  printf("\n");

  printf("ATOM COEFFICIENTS:\n");
  for (int i = 0; i != input.nprim; ++i) { 
    printf("%f\n",input.coef[i]);
  }
  printf("\n");
}

//---------------------------------------------//
//--Translate JuliaChem shell to simint_shell--//
//---------------------------------------------//
void allocate_shell_array_c(long long int nshell, 
  long long int t_nshell_simint) 
{
  //--Some variable set-up for basis set translation--//
  //int sizeof_simint_shell = 2*sizeof(int); //account for am and nprim
  //sizeof_simint_shell += 3*sizeof(double); //account for x,y and z
  //sizeof_simint_shell += 2*sizeof(double*); //account for alpha and coeff 
  //sizeof_simint_shell += sizeof(size_t); //account for memsize
  //sizeof_simint_shell += sizeof(void*); //account for ptr

  nshells = (int)nshell;
  int nshell_simint = (int)t_nshell_simint;

  //--Allocate arrays--// 
  shells = malloc(nshells*sizeof(struct simint_shell));
  sp_shell = malloc(nshells*sizeof(int));

  work = SIMINT_ALLOC(simint_ostei_workmem(0,1));
}

void add_shell_c(struct shell* p_input) 
{
  struct shell input = (*p_input);
          
  simint_initialize_shell(&shells[ishell]); 

  //int sp = input.nbas == 4;
  
  //sp_shell[ishell] = sp ? 1 : 0;

//  for (int isp = 0; isp != sp+1; ++isp) { //two iterations for L shells to split them into s and p components
    shells[ishell].x = input.atom_center[0]; 
    shells[ishell].y = input.atom_center[1];
    shells[ishell].z = input.atom_center[2]; 

    shells[ishell].am = input.am == -1 ? 1 : (int)(input.am-1); 
    shells[ishell].nprim = (int)input.nprim; 

    simint_allocate_shell(shells[ishell].nprim, &shells[ishell]);

    int nprim = (int)input.nprim;
    for (int iprim = 0; iprim != nprim; ++iprim) {
      shells[ishell].alpha[iprim] = input.exponents[iprim];
      shells[ishell].coef[iprim] = input.coefficients[iprim];
    };
    ishell += 1; 
  //}
}  

//------------------------//
//--Normalize shell list--//
//------------------------//
void normalize_shells_c()
{
  simint_normalize_shells(nshells, shells);
}

//-------------------------------------------------------------//
//--Copy list of ERIs of the form (ish jsh|ksh lsh) to ghondo--//
//-------------------------------------------------------------//
double* retrieve_eris_c(int ish, int jsh, int ksh, int lsh, double* eri) 
{
  //--initialize some variables--//
  int ii = ish-1, jj = jsh-1, kk = ksh-1, ll = lsh-1; //account for 1-indexing of ish,jsh

  //for (int i = 0; i != ish-1; ++i) ii += sp_shell[i]; //account for splitting of GAMESS L shells into s and p SIMINT shells
  //for (int j = 0; j != jsh-1; ++j) jj += sp_shell[j];
  //for (int k = 0; k != ksh-1; ++k) kk += sp_shell[k];
  //for (int l = 0; l != lsh-1; ++l) ll += sp_shell[l];

  //int fullsizes[4] = { ksize[ish-1], ksize[jsh-1], ksize[ksh-1], ksize[lsh-1] };
  //int L_[4] = { sp_shell[ish-1], sp_shell[jsh-1], sp_shell[ksh-1], sp_shell[lsh-1] };

  //--start ERI computation--//
  //if (L_[0] == 0 && L_[1] == 0 && L_[2] == 0 && L_[3] == 0)
  simgms_retrieve_eris_c_0000(ii, jj, kk, ll, eri); 
  //else
   //   simgms_retrieve_eris_c_L(ii, jj, kk, ll, ghondo, fullsizes, L_);

  return eri;
}

//--------------------------------------------------------------------------------------------------//
//--Codes for calculating ERIs for shell quartets with different numbers and positions of L shells--//
//--------------------------------------------------------------------------------------------------//
//For fxn simgms_retrieve_eris_c_ijkl, any of shells i,j,k,l = 1 means that shell is an L shell
//Ex: simgms_retrieve_eris_c_0010 handles shell quartets where the third shell is an L shell

void simgms_retrieve_eris_c_0000(int ii, int jj, int kk, int ll, double* eri) {

  int ncomputed = 0; 
  
  //--start ERI computation--//
  bool new_ij = ii != iold || jj != jold;
  if (new_ij) { 
    simint_create_multi_shellpair(1, &shells[ii], 1, &shells[jj], &left_pair, 0);
    iold = ii; jold = jj; 
  }

  simint_create_multi_shellpair(1, &shells[kk], 1, &shells[ll], &right_pair, 0);
  //printf("IJ %d, %d, %d, %d:\n", ii, jj, kk, ll);
  //printf("%d, %d, %d\n",left_pair.am1, left_pair.am2, left_pair.nprim);
  //printf("%d, %d, %d\n",left_pair.nshell12, left_pair.nshell12_clip, *(left_pair.nprim12));
  //printf("%f, %f, %f\n",*(left_pair.x), *(left_pair.y), *(left_pair.z));

  //printf("KL %d, %d, %d, %d:\n", ii, jj, kk, ll);
  //printf("%d, %d, %d\n",right_pair.am1, right_pair.am2, right_pair.nprim);
  //printf("%d, %d, %d\n",right_pair.nshell12, right_pair.nshell12_clip, *(right_pair.nprim12));
  //printf("%f, %f, %f\n",*(right_pair.x), *(right_pair.y), *(right_pair.z));
 
  ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, eri);
  //printf("%f\n",eri[0]);
}

//All code below this line is automatically generated
//-------------------------------------------------------------------//

/*



void simgms_retrieve_eris_c_L(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes, int* L_) {

    int key = 8*L_[0] + 4*L_[1] + 2*L_[2] + 1*L_[3];
    switch(key) {
        //case 0: simgms_retrieve_eris_c_0000(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 1: simgms_retrieve_eris_c_0001(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 2: simgms_retrieve_eris_c_0010(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 3: simgms_retrieve_eris_c_0011(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 4: simgms_retrieve_eris_c_0100(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 5: simgms_retrieve_eris_c_0101(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 6: simgms_retrieve_eris_c_0110(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 7: simgms_retrieve_eris_c_0111(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 8: simgms_retrieve_eris_c_1000(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 9: simgms_retrieve_eris_c_1001(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 10: simgms_retrieve_eris_c_1010(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 11: simgms_retrieve_eris_c_1011(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 12: simgms_retrieve_eris_c_1100(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 13: simgms_retrieve_eris_c_1101(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 14: simgms_retrieve_eris_c_1110(ii, jj, kk, ll, ghondo, fullsizes); break;
        case 15: simgms_retrieve_eris_c_1111(ii, jj, kk, ll, ghondo, fullsizes); break;
    };
};

void simgms_retrieve_eris_c_0001(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 0, 0, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0010(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 0, 1, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0011(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 0, 1, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0100(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 1, 0, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0101(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 1, 0, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0110(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 1, 1, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_0111(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {0, 1, 1, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 1; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1000(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 0, 0, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1001(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 0, 0, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1010(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 0, 1, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1011(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 0, 1, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 1; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1100(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 1, 0, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1101(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 1, 0, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 1; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1110(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 1, 1, 0};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 1; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

void simgms_retrieve_eris_c_1111(int ii, int jj, int kk, int ll, double* ghondo, int* fullsizes) {

    int ncomputed = 0, ntotal = 0;
    int target_idx = 0, buffer_idx = 0;
    int buffer_old = 0;
    int L_[4] = {1, 1, 1, 1};

    //--start ERI computation--//
    for (int isp = 0; isp != 2; ++isp) {
        for (int jsp = 0; jsp != 2; ++jsp) {

            bool new_ij = ii+isp != iold || jj+jsp != jold;
            if (new_ij) { 
                simint_create_multi_shellpair(1, &shells[ii+isp], 1, &shells[jj+jsp], &left_pair, 0);
                iold = ii+isp; jold = jj+jsp; 
            } 

            for (int ksp = 0; ksp != 2; ++ksp) {
                for (int lsp = 0; lsp != 2; ++lsp) {
                    int sizes[4] = { ksize_simint[ii+isp], ksize_simint[jj+jsp], ksize_simint[kk+ksp], ksize_simint[ll+lsp] }; 

                    simint_create_multi_shellpair(1, &shells[kk+ksp], 1, &shells[ll+lsp], &right_pair, 0);
                    ncomputed = simint_compute_eri(&left_pair, &right_pair, 0.0, work, target);
                    ncomputed *= sizes[0]*sizes[1]*sizes[2]*sizes[3];
                    ntotal += ncomputed;

                    //--sort separated L shells into proper GAMESS L shell order--//
                    target_idx = 0;
                    sort_L_shells_base(ghondo, target, sizes, L_, &target_idx, &buffer_idx, &buffer_old);
                }
            }
        }
    }
}

//--------------------------------//
//--Sort ERIS involving L shells--//
//--------------------------------//
void sort_L_shells_base(double* ghondo, double* target, int* sizes, int* L_,
        int* target_idx, int* buffer_idx, int* buffer_old) {

    int key = 10*10*10*10*10*10*10*sizes[0] + 10*10*10*10*10*10*sizes[1] + 10*10*10*10*10*sizes[2]
              + 10*10*10*10*sizes[3] + 10*10*10*L_[0] + 10*10*L_[1] + 10*L_[2] + L_[3];
    switch(key) {
        case 11110001: sort_L_shells_ssss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110010: sort_L_shells_ssss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110011: sort_L_shells_ssss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110100: sort_L_shells_ssss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110101: sort_L_shells_ssss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110110: sort_L_shells_ssss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11110111: sort_L_shells_ssss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111000: sort_L_shells_ssss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111001: sort_L_shells_ssss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111010: sort_L_shells_ssss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111011: sort_L_shells_ssss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111100: sort_L_shells_ssss_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111101: sort_L_shells_ssss_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111110: sort_L_shells_ssss_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11111111: sort_L_shells_ssss_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130001: sort_L_shells_sssp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130010: sort_L_shells_sssp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130011: sort_L_shells_sssp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130100: sort_L_shells_sssp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130101: sort_L_shells_sssp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130110: sort_L_shells_sssp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11130111: sort_L_shells_sssp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131000: sort_L_shells_sssp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131001: sort_L_shells_sssp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131010: sort_L_shells_sssp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131011: sort_L_shells_sssp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131100: sort_L_shells_sssp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131101: sort_L_shells_sssp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131110: sort_L_shells_sssp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11131111: sort_L_shells_sssp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11160010: sort_L_shells_sssd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11160100: sort_L_shells_sssd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11160110: sort_L_shells_sssd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11161000: sort_L_shells_sssd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11161010: sort_L_shells_sssd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11161100: sort_L_shells_sssd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11161110: sort_L_shells_sssd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11200010: sort_L_shells_sssf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11200100: sort_L_shells_sssf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11200110: sort_L_shells_sssf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11201000: sort_L_shells_sssf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11201010: sort_L_shells_sssf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11201100: sort_L_shells_sssf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11201110: sort_L_shells_sssf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11250010: sort_L_shells_sssg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11250100: sort_L_shells_sssg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11250110: sort_L_shells_sssg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11251000: sort_L_shells_sssg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11251010: sort_L_shells_sssg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11251100: sort_L_shells_sssg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11251110: sort_L_shells_sssg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310001: sort_L_shells_ssps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310010: sort_L_shells_ssps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310011: sort_L_shells_ssps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310100: sort_L_shells_ssps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310101: sort_L_shells_ssps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310110: sort_L_shells_ssps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11310111: sort_L_shells_ssps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311000: sort_L_shells_ssps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311001: sort_L_shells_ssps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311010: sort_L_shells_ssps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311011: sort_L_shells_ssps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311100: sort_L_shells_ssps_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311101: sort_L_shells_ssps_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311110: sort_L_shells_ssps_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11311111: sort_L_shells_ssps_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330001: sort_L_shells_sspp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330010: sort_L_shells_sspp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330011: sort_L_shells_sspp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330100: sort_L_shells_sspp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330101: sort_L_shells_sspp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330110: sort_L_shells_sspp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11330111: sort_L_shells_sspp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331000: sort_L_shells_sspp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331001: sort_L_shells_sspp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331010: sort_L_shells_sspp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331011: sort_L_shells_sspp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331100: sort_L_shells_sspp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331101: sort_L_shells_sspp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331110: sort_L_shells_sspp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11331111: sort_L_shells_sspp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11360010: sort_L_shells_sspd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11360100: sort_L_shells_sspd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11360110: sort_L_shells_sspd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11361000: sort_L_shells_sspd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11361010: sort_L_shells_sspd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11361100: sort_L_shells_sspd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11361110: sort_L_shells_sspd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11400010: sort_L_shells_sspf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11400100: sort_L_shells_sspf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11400110: sort_L_shells_sspf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11401000: sort_L_shells_sspf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11401010: sort_L_shells_sspf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11401100: sort_L_shells_sspf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11401110: sort_L_shells_sspf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11450010: sort_L_shells_sspg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11450100: sort_L_shells_sspg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11450110: sort_L_shells_sspg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11451000: sort_L_shells_sspg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11451010: sort_L_shells_sspg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11451100: sort_L_shells_sspg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11451110: sort_L_shells_sspg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11610001: sort_L_shells_ssds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11610100: sort_L_shells_ssds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11610101: sort_L_shells_ssds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11611000: sort_L_shells_ssds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11611001: sort_L_shells_ssds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11611100: sort_L_shells_ssds_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11611101: sort_L_shells_ssds_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11630001: sort_L_shells_ssdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11630100: sort_L_shells_ssdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11630101: sort_L_shells_ssdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11631000: sort_L_shells_ssdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11631001: sort_L_shells_ssdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11631100: sort_L_shells_ssdp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11631101: sort_L_shells_ssdp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11660100: sort_L_shells_ssdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11661000: sort_L_shells_ssdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11661100: sort_L_shells_ssdd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11700100: sort_L_shells_ssdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11701000: sort_L_shells_ssdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11701100: sort_L_shells_ssdf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11750100: sort_L_shells_ssdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11751000: sort_L_shells_ssdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 11751100: sort_L_shells_ssdg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12010001: sort_L_shells_ssfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12010100: sort_L_shells_ssfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12010101: sort_L_shells_ssfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12011000: sort_L_shells_ssfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12011001: sort_L_shells_ssfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12011100: sort_L_shells_ssfs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12011101: sort_L_shells_ssfs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12030001: sort_L_shells_ssfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12030100: sort_L_shells_ssfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12030101: sort_L_shells_ssfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12031000: sort_L_shells_ssfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12031001: sort_L_shells_ssfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12031100: sort_L_shells_ssfp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12031101: sort_L_shells_ssfp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12060100: sort_L_shells_ssfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12061000: sort_L_shells_ssfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12061100: sort_L_shells_ssfd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12100100: sort_L_shells_ssff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12101000: sort_L_shells_ssff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12101100: sort_L_shells_ssff_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12150100: sort_L_shells_ssfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12151000: sort_L_shells_ssfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12151100: sort_L_shells_ssfg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12510001: sort_L_shells_ssgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12510100: sort_L_shells_ssgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12510101: sort_L_shells_ssgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12511000: sort_L_shells_ssgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12511001: sort_L_shells_ssgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12511100: sort_L_shells_ssgs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12511101: sort_L_shells_ssgs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12530001: sort_L_shells_ssgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12530100: sort_L_shells_ssgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12530101: sort_L_shells_ssgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12531000: sort_L_shells_ssgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12531001: sort_L_shells_ssgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12531100: sort_L_shells_ssgp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12531101: sort_L_shells_ssgp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12560100: sort_L_shells_ssgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12561000: sort_L_shells_ssgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12561100: sort_L_shells_ssgd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12600100: sort_L_shells_ssgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12601000: sort_L_shells_ssgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12601100: sort_L_shells_ssgf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12650100: sort_L_shells_ssgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12651000: sort_L_shells_ssgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 12651100: sort_L_shells_ssgg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110001: sort_L_shells_spss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110010: sort_L_shells_spss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110011: sort_L_shells_spss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110100: sort_L_shells_spss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110101: sort_L_shells_spss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110110: sort_L_shells_spss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13110111: sort_L_shells_spss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111000: sort_L_shells_spss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111001: sort_L_shells_spss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111010: sort_L_shells_spss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111011: sort_L_shells_spss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111100: sort_L_shells_spss_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111101: sort_L_shells_spss_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111110: sort_L_shells_spss_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13111111: sort_L_shells_spss_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130001: sort_L_shells_spsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130010: sort_L_shells_spsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130011: sort_L_shells_spsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130100: sort_L_shells_spsp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130101: sort_L_shells_spsp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130110: sort_L_shells_spsp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13130111: sort_L_shells_spsp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131000: sort_L_shells_spsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131001: sort_L_shells_spsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131010: sort_L_shells_spsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131011: sort_L_shells_spsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131100: sort_L_shells_spsp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131101: sort_L_shells_spsp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131110: sort_L_shells_spsp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13131111: sort_L_shells_spsp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13160010: sort_L_shells_spsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13160100: sort_L_shells_spsd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13160110: sort_L_shells_spsd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13161000: sort_L_shells_spsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13161010: sort_L_shells_spsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13161100: sort_L_shells_spsd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13161110: sort_L_shells_spsd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13200010: sort_L_shells_spsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13200100: sort_L_shells_spsf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13200110: sort_L_shells_spsf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13201000: sort_L_shells_spsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13201010: sort_L_shells_spsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13201100: sort_L_shells_spsf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13201110: sort_L_shells_spsf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13250010: sort_L_shells_spsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13250100: sort_L_shells_spsg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13250110: sort_L_shells_spsg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13251000: sort_L_shells_spsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13251010: sort_L_shells_spsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13251100: sort_L_shells_spsg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13251110: sort_L_shells_spsg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310001: sort_L_shells_spps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310010: sort_L_shells_spps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310011: sort_L_shells_spps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310100: sort_L_shells_spps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310101: sort_L_shells_spps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310110: sort_L_shells_spps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13310111: sort_L_shells_spps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311000: sort_L_shells_spps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311001: sort_L_shells_spps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311010: sort_L_shells_spps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311011: sort_L_shells_spps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311100: sort_L_shells_spps_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311101: sort_L_shells_spps_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311110: sort_L_shells_spps_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13311111: sort_L_shells_spps_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330001: sort_L_shells_sppp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330010: sort_L_shells_sppp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330011: sort_L_shells_sppp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330100: sort_L_shells_sppp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330101: sort_L_shells_sppp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330110: sort_L_shells_sppp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13330111: sort_L_shells_sppp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331000: sort_L_shells_sppp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331001: sort_L_shells_sppp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331010: sort_L_shells_sppp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331011: sort_L_shells_sppp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331100: sort_L_shells_sppp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331101: sort_L_shells_sppp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331110: sort_L_shells_sppp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13331111: sort_L_shells_sppp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13360010: sort_L_shells_sppd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13360100: sort_L_shells_sppd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13360110: sort_L_shells_sppd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13361000: sort_L_shells_sppd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13361010: sort_L_shells_sppd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13361100: sort_L_shells_sppd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13361110: sort_L_shells_sppd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13400010: sort_L_shells_sppf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13400100: sort_L_shells_sppf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13400110: sort_L_shells_sppf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13401000: sort_L_shells_sppf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13401010: sort_L_shells_sppf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13401100: sort_L_shells_sppf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13401110: sort_L_shells_sppf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13450010: sort_L_shells_sppg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13450100: sort_L_shells_sppg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13450110: sort_L_shells_sppg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13451000: sort_L_shells_sppg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13451010: sort_L_shells_sppg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13451100: sort_L_shells_sppg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13451110: sort_L_shells_sppg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13610001: sort_L_shells_spds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13610100: sort_L_shells_spds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13610101: sort_L_shells_spds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13611000: sort_L_shells_spds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13611001: sort_L_shells_spds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13611100: sort_L_shells_spds_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13611101: sort_L_shells_spds_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13630001: sort_L_shells_spdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13630100: sort_L_shells_spdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13630101: sort_L_shells_spdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13631000: sort_L_shells_spdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13631001: sort_L_shells_spdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13631100: sort_L_shells_spdp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13631101: sort_L_shells_spdp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13660100: sort_L_shells_spdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13661000: sort_L_shells_spdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13661100: sort_L_shells_spdd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13700100: sort_L_shells_spdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13701000: sort_L_shells_spdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13701100: sort_L_shells_spdf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13750100: sort_L_shells_spdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13751000: sort_L_shells_spdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 13751100: sort_L_shells_spdg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14010001: sort_L_shells_spfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14010100: sort_L_shells_spfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14010101: sort_L_shells_spfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14011000: sort_L_shells_spfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14011001: sort_L_shells_spfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14011100: sort_L_shells_spfs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14011101: sort_L_shells_spfs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14030001: sort_L_shells_spfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14030100: sort_L_shells_spfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14030101: sort_L_shells_spfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14031000: sort_L_shells_spfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14031001: sort_L_shells_spfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14031100: sort_L_shells_spfp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14031101: sort_L_shells_spfp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14060100: sort_L_shells_spfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14061000: sort_L_shells_spfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14061100: sort_L_shells_spfd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14100100: sort_L_shells_spff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14101000: sort_L_shells_spff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14101100: sort_L_shells_spff_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14150100: sort_L_shells_spfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14151000: sort_L_shells_spfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14151100: sort_L_shells_spfg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14510001: sort_L_shells_spgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14510100: sort_L_shells_spgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14510101: sort_L_shells_spgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14511000: sort_L_shells_spgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14511001: sort_L_shells_spgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14511100: sort_L_shells_spgs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14511101: sort_L_shells_spgs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14530001: sort_L_shells_spgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14530100: sort_L_shells_spgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14530101: sort_L_shells_spgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14531000: sort_L_shells_spgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14531001: sort_L_shells_spgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14531100: sort_L_shells_spgp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14531101: sort_L_shells_spgp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14560100: sort_L_shells_spgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14561000: sort_L_shells_spgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14561100: sort_L_shells_spgd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14600100: sort_L_shells_spgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14601000: sort_L_shells_spgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14601100: sort_L_shells_spgf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14650100: sort_L_shells_spgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14651000: sort_L_shells_spgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 14651100: sort_L_shells_spgg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16110001: sort_L_shells_sdss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16110010: sort_L_shells_sdss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16110011: sort_L_shells_sdss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16111000: sort_L_shells_sdss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16111001: sort_L_shells_sdss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16111010: sort_L_shells_sdss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16111011: sort_L_shells_sdss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16130001: sort_L_shells_sdsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16130010: sort_L_shells_sdsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16130011: sort_L_shells_sdsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16131000: sort_L_shells_sdsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16131001: sort_L_shells_sdsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16131010: sort_L_shells_sdsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16131011: sort_L_shells_sdsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16160010: sort_L_shells_sdsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16161000: sort_L_shells_sdsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16161010: sort_L_shells_sdsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16200010: sort_L_shells_sdsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16201000: sort_L_shells_sdsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16201010: sort_L_shells_sdsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16250010: sort_L_shells_sdsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16251000: sort_L_shells_sdsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16251010: sort_L_shells_sdsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16310001: sort_L_shells_sdps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16310010: sort_L_shells_sdps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16310011: sort_L_shells_sdps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16311000: sort_L_shells_sdps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16311001: sort_L_shells_sdps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16311010: sort_L_shells_sdps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16311011: sort_L_shells_sdps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16330001: sort_L_shells_sdpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16330010: sort_L_shells_sdpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16330011: sort_L_shells_sdpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16331000: sort_L_shells_sdpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16331001: sort_L_shells_sdpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16331010: sort_L_shells_sdpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16331011: sort_L_shells_sdpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16360010: sort_L_shells_sdpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16361000: sort_L_shells_sdpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16361010: sort_L_shells_sdpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16400010: sort_L_shells_sdpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16401000: sort_L_shells_sdpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16401010: sort_L_shells_sdpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16450010: sort_L_shells_sdpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16451000: sort_L_shells_sdpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16451010: sort_L_shells_sdpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16610001: sort_L_shells_sdds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16611000: sort_L_shells_sdds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16611001: sort_L_shells_sdds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16630001: sort_L_shells_sddp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16631000: sort_L_shells_sddp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16631001: sort_L_shells_sddp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16661000: sort_L_shells_sddd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16701000: sort_L_shells_sddf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 16751000: sort_L_shells_sddg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17010001: sort_L_shells_sdfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17011000: sort_L_shells_sdfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17011001: sort_L_shells_sdfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17030001: sort_L_shells_sdfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17031000: sort_L_shells_sdfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17031001: sort_L_shells_sdfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17061000: sort_L_shells_sdfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17101000: sort_L_shells_sdff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17151000: sort_L_shells_sdfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17510001: sort_L_shells_sdgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17511000: sort_L_shells_sdgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17511001: sort_L_shells_sdgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17530001: sort_L_shells_sdgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17531000: sort_L_shells_sdgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17531001: sort_L_shells_sdgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17561000: sort_L_shells_sdgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17601000: sort_L_shells_sdgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 17651000: sort_L_shells_sdgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20110001: sort_L_shells_sfss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20110010: sort_L_shells_sfss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20110011: sort_L_shells_sfss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20111000: sort_L_shells_sfss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20111001: sort_L_shells_sfss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20111010: sort_L_shells_sfss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20111011: sort_L_shells_sfss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20130001: sort_L_shells_sfsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20130010: sort_L_shells_sfsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20130011: sort_L_shells_sfsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20131000: sort_L_shells_sfsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20131001: sort_L_shells_sfsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20131010: sort_L_shells_sfsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20131011: sort_L_shells_sfsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20160010: sort_L_shells_sfsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20161000: sort_L_shells_sfsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20161010: sort_L_shells_sfsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20200010: sort_L_shells_sfsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20201000: sort_L_shells_sfsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20201010: sort_L_shells_sfsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20250010: sort_L_shells_sfsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20251000: sort_L_shells_sfsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20251010: sort_L_shells_sfsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20310001: sort_L_shells_sfps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20310010: sort_L_shells_sfps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20310011: sort_L_shells_sfps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20311000: sort_L_shells_sfps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20311001: sort_L_shells_sfps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20311010: sort_L_shells_sfps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20311011: sort_L_shells_sfps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20330001: sort_L_shells_sfpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20330010: sort_L_shells_sfpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20330011: sort_L_shells_sfpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20331000: sort_L_shells_sfpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20331001: sort_L_shells_sfpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20331010: sort_L_shells_sfpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20331011: sort_L_shells_sfpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20360010: sort_L_shells_sfpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20361000: sort_L_shells_sfpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20361010: sort_L_shells_sfpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20400010: sort_L_shells_sfpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20401000: sort_L_shells_sfpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20401010: sort_L_shells_sfpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20450010: sort_L_shells_sfpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20451000: sort_L_shells_sfpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20451010: sort_L_shells_sfpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20610001: sort_L_shells_sfds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20611000: sort_L_shells_sfds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20611001: sort_L_shells_sfds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20630001: sort_L_shells_sfdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20631000: sort_L_shells_sfdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20631001: sort_L_shells_sfdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20661000: sort_L_shells_sfdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20701000: sort_L_shells_sfdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 20751000: sort_L_shells_sfdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21010001: sort_L_shells_sffs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21011000: sort_L_shells_sffs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21011001: sort_L_shells_sffs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21030001: sort_L_shells_sffp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21031000: sort_L_shells_sffp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21031001: sort_L_shells_sffp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21061000: sort_L_shells_sffd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21101000: sort_L_shells_sfff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21151000: sort_L_shells_sffg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21510001: sort_L_shells_sfgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21511000: sort_L_shells_sfgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21511001: sort_L_shells_sfgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21530001: sort_L_shells_sfgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21531000: sort_L_shells_sfgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21531001: sort_L_shells_sfgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21561000: sort_L_shells_sfgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21601000: sort_L_shells_sfgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 21651000: sort_L_shells_sfgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25110001: sort_L_shells_sgss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25110010: sort_L_shells_sgss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25110011: sort_L_shells_sgss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25111000: sort_L_shells_sgss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25111001: sort_L_shells_sgss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25111010: sort_L_shells_sgss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25111011: sort_L_shells_sgss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25130001: sort_L_shells_sgsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25130010: sort_L_shells_sgsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25130011: sort_L_shells_sgsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25131000: sort_L_shells_sgsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25131001: sort_L_shells_sgsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25131010: sort_L_shells_sgsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25131011: sort_L_shells_sgsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25160010: sort_L_shells_sgsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25161000: sort_L_shells_sgsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25161010: sort_L_shells_sgsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25200010: sort_L_shells_sgsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25201000: sort_L_shells_sgsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25201010: sort_L_shells_sgsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25250010: sort_L_shells_sgsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25251000: sort_L_shells_sgsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25251010: sort_L_shells_sgsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25310001: sort_L_shells_sgps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25310010: sort_L_shells_sgps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25310011: sort_L_shells_sgps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25311000: sort_L_shells_sgps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25311001: sort_L_shells_sgps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25311010: sort_L_shells_sgps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25311011: sort_L_shells_sgps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25330001: sort_L_shells_sgpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25330010: sort_L_shells_sgpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25330011: sort_L_shells_sgpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25331000: sort_L_shells_sgpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25331001: sort_L_shells_sgpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25331010: sort_L_shells_sgpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25331011: sort_L_shells_sgpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25360010: sort_L_shells_sgpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25361000: sort_L_shells_sgpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25361010: sort_L_shells_sgpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25400010: sort_L_shells_sgpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25401000: sort_L_shells_sgpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25401010: sort_L_shells_sgpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25450010: sort_L_shells_sgpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25451000: sort_L_shells_sgpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25451010: sort_L_shells_sgpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25610001: sort_L_shells_sgds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25611000: sort_L_shells_sgds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25611001: sort_L_shells_sgds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25630001: sort_L_shells_sgdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25631000: sort_L_shells_sgdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25631001: sort_L_shells_sgdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25661000: sort_L_shells_sgdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25701000: sort_L_shells_sgdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 25751000: sort_L_shells_sgdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26010001: sort_L_shells_sgfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26011000: sort_L_shells_sgfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26011001: sort_L_shells_sgfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26030001: sort_L_shells_sgfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26031000: sort_L_shells_sgfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26031001: sort_L_shells_sgfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26061000: sort_L_shells_sgfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26101000: sort_L_shells_sgff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26151000: sort_L_shells_sgfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26510001: sort_L_shells_sggs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26511000: sort_L_shells_sggs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26511001: sort_L_shells_sggs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26530001: sort_L_shells_sggp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26531000: sort_L_shells_sggp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26531001: sort_L_shells_sggp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26561000: sort_L_shells_sggd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26601000: sort_L_shells_sggf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 26651000: sort_L_shells_sggg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110001: sort_L_shells_psss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110010: sort_L_shells_psss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110011: sort_L_shells_psss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110100: sort_L_shells_psss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110101: sort_L_shells_psss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110110: sort_L_shells_psss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31110111: sort_L_shells_psss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111000: sort_L_shells_psss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111001: sort_L_shells_psss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111010: sort_L_shells_psss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111011: sort_L_shells_psss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111100: sort_L_shells_psss_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111101: sort_L_shells_psss_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111110: sort_L_shells_psss_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31111111: sort_L_shells_psss_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130001: sort_L_shells_pssp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130010: sort_L_shells_pssp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130011: sort_L_shells_pssp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130100: sort_L_shells_pssp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130101: sort_L_shells_pssp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130110: sort_L_shells_pssp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31130111: sort_L_shells_pssp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131000: sort_L_shells_pssp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131001: sort_L_shells_pssp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131010: sort_L_shells_pssp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131011: sort_L_shells_pssp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131100: sort_L_shells_pssp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131101: sort_L_shells_pssp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131110: sort_L_shells_pssp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31131111: sort_L_shells_pssp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31160010: sort_L_shells_pssd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31160100: sort_L_shells_pssd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31160110: sort_L_shells_pssd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31161000: sort_L_shells_pssd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31161010: sort_L_shells_pssd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31161100: sort_L_shells_pssd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31161110: sort_L_shells_pssd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31200010: sort_L_shells_pssf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31200100: sort_L_shells_pssf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31200110: sort_L_shells_pssf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31201000: sort_L_shells_pssf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31201010: sort_L_shells_pssf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31201100: sort_L_shells_pssf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31201110: sort_L_shells_pssf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31250010: sort_L_shells_pssg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31250100: sort_L_shells_pssg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31250110: sort_L_shells_pssg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31251000: sort_L_shells_pssg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31251010: sort_L_shells_pssg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31251100: sort_L_shells_pssg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31251110: sort_L_shells_pssg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310001: sort_L_shells_psps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310010: sort_L_shells_psps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310011: sort_L_shells_psps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310100: sort_L_shells_psps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310101: sort_L_shells_psps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310110: sort_L_shells_psps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31310111: sort_L_shells_psps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311000: sort_L_shells_psps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311001: sort_L_shells_psps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311010: sort_L_shells_psps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311011: sort_L_shells_psps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311100: sort_L_shells_psps_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311101: sort_L_shells_psps_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311110: sort_L_shells_psps_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31311111: sort_L_shells_psps_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330001: sort_L_shells_pspp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330010: sort_L_shells_pspp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330011: sort_L_shells_pspp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330100: sort_L_shells_pspp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330101: sort_L_shells_pspp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330110: sort_L_shells_pspp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31330111: sort_L_shells_pspp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331000: sort_L_shells_pspp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331001: sort_L_shells_pspp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331010: sort_L_shells_pspp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331011: sort_L_shells_pspp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331100: sort_L_shells_pspp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331101: sort_L_shells_pspp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331110: sort_L_shells_pspp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31331111: sort_L_shells_pspp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31360010: sort_L_shells_pspd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31360100: sort_L_shells_pspd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31360110: sort_L_shells_pspd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31361000: sort_L_shells_pspd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31361010: sort_L_shells_pspd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31361100: sort_L_shells_pspd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31361110: sort_L_shells_pspd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31400010: sort_L_shells_pspf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31400100: sort_L_shells_pspf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31400110: sort_L_shells_pspf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31401000: sort_L_shells_pspf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31401010: sort_L_shells_pspf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31401100: sort_L_shells_pspf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31401110: sort_L_shells_pspf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31450010: sort_L_shells_pspg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31450100: sort_L_shells_pspg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31450110: sort_L_shells_pspg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31451000: sort_L_shells_pspg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31451010: sort_L_shells_pspg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31451100: sort_L_shells_pspg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31451110: sort_L_shells_pspg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31610001: sort_L_shells_psds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31610100: sort_L_shells_psds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31610101: sort_L_shells_psds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31611000: sort_L_shells_psds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31611001: sort_L_shells_psds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31611100: sort_L_shells_psds_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31611101: sort_L_shells_psds_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31630001: sort_L_shells_psdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31630100: sort_L_shells_psdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31630101: sort_L_shells_psdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31631000: sort_L_shells_psdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31631001: sort_L_shells_psdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31631100: sort_L_shells_psdp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31631101: sort_L_shells_psdp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31660100: sort_L_shells_psdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31661000: sort_L_shells_psdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31661100: sort_L_shells_psdd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31700100: sort_L_shells_psdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31701000: sort_L_shells_psdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31701100: sort_L_shells_psdf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31750100: sort_L_shells_psdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31751000: sort_L_shells_psdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 31751100: sort_L_shells_psdg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32010001: sort_L_shells_psfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32010100: sort_L_shells_psfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32010101: sort_L_shells_psfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32011000: sort_L_shells_psfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32011001: sort_L_shells_psfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32011100: sort_L_shells_psfs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32011101: sort_L_shells_psfs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32030001: sort_L_shells_psfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32030100: sort_L_shells_psfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32030101: sort_L_shells_psfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32031000: sort_L_shells_psfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32031001: sort_L_shells_psfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32031100: sort_L_shells_psfp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32031101: sort_L_shells_psfp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32060100: sort_L_shells_psfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32061000: sort_L_shells_psfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32061100: sort_L_shells_psfd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32100100: sort_L_shells_psff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32101000: sort_L_shells_psff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32101100: sort_L_shells_psff_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32150100: sort_L_shells_psfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32151000: sort_L_shells_psfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32151100: sort_L_shells_psfg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32510001: sort_L_shells_psgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32510100: sort_L_shells_psgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32510101: sort_L_shells_psgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32511000: sort_L_shells_psgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32511001: sort_L_shells_psgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32511100: sort_L_shells_psgs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32511101: sort_L_shells_psgs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32530001: sort_L_shells_psgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32530100: sort_L_shells_psgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32530101: sort_L_shells_psgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32531000: sort_L_shells_psgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32531001: sort_L_shells_psgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32531100: sort_L_shells_psgp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32531101: sort_L_shells_psgp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32560100: sort_L_shells_psgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32561000: sort_L_shells_psgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32561100: sort_L_shells_psgd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32600100: sort_L_shells_psgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32601000: sort_L_shells_psgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32601100: sort_L_shells_psgf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32650100: sort_L_shells_psgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32651000: sort_L_shells_psgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 32651100: sort_L_shells_psgg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110001: sort_L_shells_ppss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110010: sort_L_shells_ppss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110011: sort_L_shells_ppss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110100: sort_L_shells_ppss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110101: sort_L_shells_ppss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110110: sort_L_shells_ppss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33110111: sort_L_shells_ppss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111000: sort_L_shells_ppss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111001: sort_L_shells_ppss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111010: sort_L_shells_ppss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111011: sort_L_shells_ppss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111100: sort_L_shells_ppss_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111101: sort_L_shells_ppss_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111110: sort_L_shells_ppss_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33111111: sort_L_shells_ppss_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130001: sort_L_shells_ppsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130010: sort_L_shells_ppsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130011: sort_L_shells_ppsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130100: sort_L_shells_ppsp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130101: sort_L_shells_ppsp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130110: sort_L_shells_ppsp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33130111: sort_L_shells_ppsp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131000: sort_L_shells_ppsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131001: sort_L_shells_ppsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131010: sort_L_shells_ppsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131011: sort_L_shells_ppsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131100: sort_L_shells_ppsp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131101: sort_L_shells_ppsp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131110: sort_L_shells_ppsp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33131111: sort_L_shells_ppsp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33160010: sort_L_shells_ppsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33160100: sort_L_shells_ppsd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33160110: sort_L_shells_ppsd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33161000: sort_L_shells_ppsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33161010: sort_L_shells_ppsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33161100: sort_L_shells_ppsd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33161110: sort_L_shells_ppsd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33200010: sort_L_shells_ppsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33200100: sort_L_shells_ppsf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33200110: sort_L_shells_ppsf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33201000: sort_L_shells_ppsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33201010: sort_L_shells_ppsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33201100: sort_L_shells_ppsf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33201110: sort_L_shells_ppsf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33250010: sort_L_shells_ppsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33250100: sort_L_shells_ppsg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33250110: sort_L_shells_ppsg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33251000: sort_L_shells_ppsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33251010: sort_L_shells_ppsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33251100: sort_L_shells_ppsg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33251110: sort_L_shells_ppsg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310001: sort_L_shells_ppps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310010: sort_L_shells_ppps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310011: sort_L_shells_ppps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310100: sort_L_shells_ppps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310101: sort_L_shells_ppps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310110: sort_L_shells_ppps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33310111: sort_L_shells_ppps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311000: sort_L_shells_ppps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311001: sort_L_shells_ppps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311010: sort_L_shells_ppps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311011: sort_L_shells_ppps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311100: sort_L_shells_ppps_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311101: sort_L_shells_ppps_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311110: sort_L_shells_ppps_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33311111: sort_L_shells_ppps_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330001: sort_L_shells_pppp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330010: sort_L_shells_pppp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330011: sort_L_shells_pppp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330100: sort_L_shells_pppp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330101: sort_L_shells_pppp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330110: sort_L_shells_pppp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33330111: sort_L_shells_pppp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331000: sort_L_shells_pppp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331001: sort_L_shells_pppp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331010: sort_L_shells_pppp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331011: sort_L_shells_pppp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331100: sort_L_shells_pppp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331101: sort_L_shells_pppp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331110: sort_L_shells_pppp_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33331111: sort_L_shells_pppp_1111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33360010: sort_L_shells_pppd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33360100: sort_L_shells_pppd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33360110: sort_L_shells_pppd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33361000: sort_L_shells_pppd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33361010: sort_L_shells_pppd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33361100: sort_L_shells_pppd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33361110: sort_L_shells_pppd_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33400010: sort_L_shells_pppf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33400100: sort_L_shells_pppf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33400110: sort_L_shells_pppf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33401000: sort_L_shells_pppf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33401010: sort_L_shells_pppf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33401100: sort_L_shells_pppf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33401110: sort_L_shells_pppf_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33450010: sort_L_shells_pppg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33450100: sort_L_shells_pppg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33450110: sort_L_shells_pppg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33451000: sort_L_shells_pppg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33451010: sort_L_shells_pppg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33451100: sort_L_shells_pppg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33451110: sort_L_shells_pppg_1110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33610001: sort_L_shells_ppds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33610100: sort_L_shells_ppds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33610101: sort_L_shells_ppds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33611000: sort_L_shells_ppds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33611001: sort_L_shells_ppds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33611100: sort_L_shells_ppds_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33611101: sort_L_shells_ppds_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33630001: sort_L_shells_ppdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33630100: sort_L_shells_ppdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33630101: sort_L_shells_ppdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33631000: sort_L_shells_ppdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33631001: sort_L_shells_ppdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33631100: sort_L_shells_ppdp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33631101: sort_L_shells_ppdp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33660100: sort_L_shells_ppdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33661000: sort_L_shells_ppdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33661100: sort_L_shells_ppdd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33700100: sort_L_shells_ppdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33701000: sort_L_shells_ppdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33701100: sort_L_shells_ppdf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33750100: sort_L_shells_ppdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33751000: sort_L_shells_ppdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 33751100: sort_L_shells_ppdg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34010001: sort_L_shells_ppfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34010100: sort_L_shells_ppfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34010101: sort_L_shells_ppfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34011000: sort_L_shells_ppfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34011001: sort_L_shells_ppfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34011100: sort_L_shells_ppfs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34011101: sort_L_shells_ppfs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34030001: sort_L_shells_ppfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34030100: sort_L_shells_ppfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34030101: sort_L_shells_ppfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34031000: sort_L_shells_ppfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34031001: sort_L_shells_ppfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34031100: sort_L_shells_ppfp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34031101: sort_L_shells_ppfp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34060100: sort_L_shells_ppfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34061000: sort_L_shells_ppfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34061100: sort_L_shells_ppfd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34100100: sort_L_shells_ppff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34101000: sort_L_shells_ppff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34101100: sort_L_shells_ppff_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34150100: sort_L_shells_ppfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34151000: sort_L_shells_ppfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34151100: sort_L_shells_ppfg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34510001: sort_L_shells_ppgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34510100: sort_L_shells_ppgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34510101: sort_L_shells_ppgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34511000: sort_L_shells_ppgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34511001: sort_L_shells_ppgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34511100: sort_L_shells_ppgs_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34511101: sort_L_shells_ppgs_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34530001: sort_L_shells_ppgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34530100: sort_L_shells_ppgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34530101: sort_L_shells_ppgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34531000: sort_L_shells_ppgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34531001: sort_L_shells_ppgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34531100: sort_L_shells_ppgp_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34531101: sort_L_shells_ppgp_1101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34560100: sort_L_shells_ppgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34561000: sort_L_shells_ppgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34561100: sort_L_shells_ppgd_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34600100: sort_L_shells_ppgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34601000: sort_L_shells_ppgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34601100: sort_L_shells_ppgf_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34650100: sort_L_shells_ppgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34651000: sort_L_shells_ppgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 34651100: sort_L_shells_ppgg_1100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36110001: sort_L_shells_pdss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36110010: sort_L_shells_pdss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36110011: sort_L_shells_pdss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36111000: sort_L_shells_pdss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36111001: sort_L_shells_pdss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36111010: sort_L_shells_pdss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36111011: sort_L_shells_pdss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36130001: sort_L_shells_pdsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36130010: sort_L_shells_pdsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36130011: sort_L_shells_pdsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36131000: sort_L_shells_pdsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36131001: sort_L_shells_pdsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36131010: sort_L_shells_pdsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36131011: sort_L_shells_pdsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36160010: sort_L_shells_pdsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36161000: sort_L_shells_pdsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36161010: sort_L_shells_pdsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36200010: sort_L_shells_pdsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36201000: sort_L_shells_pdsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36201010: sort_L_shells_pdsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36250010: sort_L_shells_pdsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36251000: sort_L_shells_pdsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36251010: sort_L_shells_pdsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36310001: sort_L_shells_pdps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36310010: sort_L_shells_pdps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36310011: sort_L_shells_pdps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36311000: sort_L_shells_pdps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36311001: sort_L_shells_pdps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36311010: sort_L_shells_pdps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36311011: sort_L_shells_pdps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36330001: sort_L_shells_pdpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36330010: sort_L_shells_pdpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36330011: sort_L_shells_pdpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36331000: sort_L_shells_pdpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36331001: sort_L_shells_pdpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36331010: sort_L_shells_pdpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36331011: sort_L_shells_pdpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36360010: sort_L_shells_pdpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36361000: sort_L_shells_pdpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36361010: sort_L_shells_pdpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36400010: sort_L_shells_pdpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36401000: sort_L_shells_pdpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36401010: sort_L_shells_pdpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36450010: sort_L_shells_pdpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36451000: sort_L_shells_pdpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36451010: sort_L_shells_pdpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36610001: sort_L_shells_pdds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36611000: sort_L_shells_pdds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36611001: sort_L_shells_pdds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36630001: sort_L_shells_pddp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36631000: sort_L_shells_pddp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36631001: sort_L_shells_pddp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36661000: sort_L_shells_pddd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36701000: sort_L_shells_pddf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 36751000: sort_L_shells_pddg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37010001: sort_L_shells_pdfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37011000: sort_L_shells_pdfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37011001: sort_L_shells_pdfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37030001: sort_L_shells_pdfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37031000: sort_L_shells_pdfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37031001: sort_L_shells_pdfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37061000: sort_L_shells_pdfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37101000: sort_L_shells_pdff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37151000: sort_L_shells_pdfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37510001: sort_L_shells_pdgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37511000: sort_L_shells_pdgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37511001: sort_L_shells_pdgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37530001: sort_L_shells_pdgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37531000: sort_L_shells_pdgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37531001: sort_L_shells_pdgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37561000: sort_L_shells_pdgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37601000: sort_L_shells_pdgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 37651000: sort_L_shells_pdgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40110001: sort_L_shells_pfss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40110010: sort_L_shells_pfss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40110011: sort_L_shells_pfss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40111000: sort_L_shells_pfss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40111001: sort_L_shells_pfss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40111010: sort_L_shells_pfss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40111011: sort_L_shells_pfss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40130001: sort_L_shells_pfsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40130010: sort_L_shells_pfsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40130011: sort_L_shells_pfsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40131000: sort_L_shells_pfsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40131001: sort_L_shells_pfsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40131010: sort_L_shells_pfsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40131011: sort_L_shells_pfsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40160010: sort_L_shells_pfsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40161000: sort_L_shells_pfsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40161010: sort_L_shells_pfsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40200010: sort_L_shells_pfsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40201000: sort_L_shells_pfsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40201010: sort_L_shells_pfsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40250010: sort_L_shells_pfsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40251000: sort_L_shells_pfsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40251010: sort_L_shells_pfsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40310001: sort_L_shells_pfps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40310010: sort_L_shells_pfps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40310011: sort_L_shells_pfps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40311000: sort_L_shells_pfps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40311001: sort_L_shells_pfps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40311010: sort_L_shells_pfps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40311011: sort_L_shells_pfps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40330001: sort_L_shells_pfpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40330010: sort_L_shells_pfpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40330011: sort_L_shells_pfpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40331000: sort_L_shells_pfpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40331001: sort_L_shells_pfpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40331010: sort_L_shells_pfpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40331011: sort_L_shells_pfpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40360010: sort_L_shells_pfpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40361000: sort_L_shells_pfpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40361010: sort_L_shells_pfpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40400010: sort_L_shells_pfpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40401000: sort_L_shells_pfpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40401010: sort_L_shells_pfpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40450010: sort_L_shells_pfpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40451000: sort_L_shells_pfpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40451010: sort_L_shells_pfpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40610001: sort_L_shells_pfds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40611000: sort_L_shells_pfds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40611001: sort_L_shells_pfds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40630001: sort_L_shells_pfdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40631000: sort_L_shells_pfdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40631001: sort_L_shells_pfdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40661000: sort_L_shells_pfdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40701000: sort_L_shells_pfdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 40751000: sort_L_shells_pfdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41010001: sort_L_shells_pffs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41011000: sort_L_shells_pffs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41011001: sort_L_shells_pffs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41030001: sort_L_shells_pffp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41031000: sort_L_shells_pffp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41031001: sort_L_shells_pffp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41061000: sort_L_shells_pffd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41101000: sort_L_shells_pfff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41151000: sort_L_shells_pffg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41510001: sort_L_shells_pfgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41511000: sort_L_shells_pfgs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41511001: sort_L_shells_pfgs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41530001: sort_L_shells_pfgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41531000: sort_L_shells_pfgp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41531001: sort_L_shells_pfgp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41561000: sort_L_shells_pfgd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41601000: sort_L_shells_pfgf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 41651000: sort_L_shells_pfgg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45110001: sort_L_shells_pgss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45110010: sort_L_shells_pgss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45110011: sort_L_shells_pgss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45111000: sort_L_shells_pgss_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45111001: sort_L_shells_pgss_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45111010: sort_L_shells_pgss_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45111011: sort_L_shells_pgss_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45130001: sort_L_shells_pgsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45130010: sort_L_shells_pgsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45130011: sort_L_shells_pgsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45131000: sort_L_shells_pgsp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45131001: sort_L_shells_pgsp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45131010: sort_L_shells_pgsp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45131011: sort_L_shells_pgsp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45160010: sort_L_shells_pgsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45161000: sort_L_shells_pgsd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45161010: sort_L_shells_pgsd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45200010: sort_L_shells_pgsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45201000: sort_L_shells_pgsf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45201010: sort_L_shells_pgsf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45250010: sort_L_shells_pgsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45251000: sort_L_shells_pgsg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45251010: sort_L_shells_pgsg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45310001: sort_L_shells_pgps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45310010: sort_L_shells_pgps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45310011: sort_L_shells_pgps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45311000: sort_L_shells_pgps_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45311001: sort_L_shells_pgps_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45311010: sort_L_shells_pgps_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45311011: sort_L_shells_pgps_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45330001: sort_L_shells_pgpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45330010: sort_L_shells_pgpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45330011: sort_L_shells_pgpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45331000: sort_L_shells_pgpp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45331001: sort_L_shells_pgpp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45331010: sort_L_shells_pgpp_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45331011: sort_L_shells_pgpp_1011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45360010: sort_L_shells_pgpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45361000: sort_L_shells_pgpd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45361010: sort_L_shells_pgpd_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45400010: sort_L_shells_pgpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45401000: sort_L_shells_pgpf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45401010: sort_L_shells_pgpf_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45450010: sort_L_shells_pgpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45451000: sort_L_shells_pgpg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45451010: sort_L_shells_pgpg_1010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45610001: sort_L_shells_pgds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45611000: sort_L_shells_pgds_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45611001: sort_L_shells_pgds_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45630001: sort_L_shells_pgdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45631000: sort_L_shells_pgdp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45631001: sort_L_shells_pgdp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45661000: sort_L_shells_pgdd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45701000: sort_L_shells_pgdf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 45751000: sort_L_shells_pgdg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46010001: sort_L_shells_pgfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46011000: sort_L_shells_pgfs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46011001: sort_L_shells_pgfs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46030001: sort_L_shells_pgfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46031000: sort_L_shells_pgfp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46031001: sort_L_shells_pgfp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46061000: sort_L_shells_pgfd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46101000: sort_L_shells_pgff_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46151000: sort_L_shells_pgfg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46510001: sort_L_shells_pggs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46511000: sort_L_shells_pggs_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46511001: sort_L_shells_pggs_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46530001: sort_L_shells_pggp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46531000: sort_L_shells_pggp_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46531001: sort_L_shells_pggp_1001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46561000: sort_L_shells_pggd_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46601000: sort_L_shells_pggf_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 46651000: sort_L_shells_pggg_1000(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110001: sort_L_shells_dsss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110010: sort_L_shells_dsss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110011: sort_L_shells_dsss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110100: sort_L_shells_dsss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110101: sort_L_shells_dsss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110110: sort_L_shells_dsss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61110111: sort_L_shells_dsss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130001: sort_L_shells_dssp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130010: sort_L_shells_dssp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130011: sort_L_shells_dssp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130100: sort_L_shells_dssp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130101: sort_L_shells_dssp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130110: sort_L_shells_dssp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61130111: sort_L_shells_dssp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61160010: sort_L_shells_dssd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61160100: sort_L_shells_dssd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61160110: sort_L_shells_dssd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61200010: sort_L_shells_dssf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61200100: sort_L_shells_dssf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61200110: sort_L_shells_dssf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61250010: sort_L_shells_dssg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61250100: sort_L_shells_dssg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61250110: sort_L_shells_dssg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310001: sort_L_shells_dsps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310010: sort_L_shells_dsps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310011: sort_L_shells_dsps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310100: sort_L_shells_dsps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310101: sort_L_shells_dsps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310110: sort_L_shells_dsps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61310111: sort_L_shells_dsps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330001: sort_L_shells_dspp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330010: sort_L_shells_dspp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330011: sort_L_shells_dspp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330100: sort_L_shells_dspp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330101: sort_L_shells_dspp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330110: sort_L_shells_dspp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61330111: sort_L_shells_dspp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61360010: sort_L_shells_dspd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61360100: sort_L_shells_dspd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61360110: sort_L_shells_dspd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61400010: sort_L_shells_dspf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61400100: sort_L_shells_dspf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61400110: sort_L_shells_dspf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61450010: sort_L_shells_dspg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61450100: sort_L_shells_dspg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61450110: sort_L_shells_dspg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61610001: sort_L_shells_dsds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61610100: sort_L_shells_dsds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61610101: sort_L_shells_dsds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61630001: sort_L_shells_dsdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61630100: sort_L_shells_dsdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61630101: sort_L_shells_dsdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61660100: sort_L_shells_dsdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61700100: sort_L_shells_dsdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 61750100: sort_L_shells_dsdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62010001: sort_L_shells_dsfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62010100: sort_L_shells_dsfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62010101: sort_L_shells_dsfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62030001: sort_L_shells_dsfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62030100: sort_L_shells_dsfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62030101: sort_L_shells_dsfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62060100: sort_L_shells_dsfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62100100: sort_L_shells_dsff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62150100: sort_L_shells_dsfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62510001: sort_L_shells_dsgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62510100: sort_L_shells_dsgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62510101: sort_L_shells_dsgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62530001: sort_L_shells_dsgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62530100: sort_L_shells_dsgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62530101: sort_L_shells_dsgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62560100: sort_L_shells_dsgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62600100: sort_L_shells_dsgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 62650100: sort_L_shells_dsgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110001: sort_L_shells_dpss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110010: sort_L_shells_dpss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110011: sort_L_shells_dpss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110100: sort_L_shells_dpss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110101: sort_L_shells_dpss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110110: sort_L_shells_dpss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63110111: sort_L_shells_dpss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130001: sort_L_shells_dpsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130010: sort_L_shells_dpsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130011: sort_L_shells_dpsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130100: sort_L_shells_dpsp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130101: sort_L_shells_dpsp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130110: sort_L_shells_dpsp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63130111: sort_L_shells_dpsp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63160010: sort_L_shells_dpsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63160100: sort_L_shells_dpsd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63160110: sort_L_shells_dpsd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63200010: sort_L_shells_dpsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63200100: sort_L_shells_dpsf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63200110: sort_L_shells_dpsf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63250010: sort_L_shells_dpsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63250100: sort_L_shells_dpsg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63250110: sort_L_shells_dpsg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310001: sort_L_shells_dpps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310010: sort_L_shells_dpps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310011: sort_L_shells_dpps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310100: sort_L_shells_dpps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310101: sort_L_shells_dpps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310110: sort_L_shells_dpps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63310111: sort_L_shells_dpps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330001: sort_L_shells_dppp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330010: sort_L_shells_dppp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330011: sort_L_shells_dppp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330100: sort_L_shells_dppp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330101: sort_L_shells_dppp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330110: sort_L_shells_dppp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63330111: sort_L_shells_dppp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63360010: sort_L_shells_dppd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63360100: sort_L_shells_dppd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63360110: sort_L_shells_dppd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63400010: sort_L_shells_dppf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63400100: sort_L_shells_dppf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63400110: sort_L_shells_dppf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63450010: sort_L_shells_dppg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63450100: sort_L_shells_dppg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63450110: sort_L_shells_dppg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63610001: sort_L_shells_dpds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63610100: sort_L_shells_dpds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63610101: sort_L_shells_dpds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63630001: sort_L_shells_dpdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63630100: sort_L_shells_dpdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63630101: sort_L_shells_dpdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63660100: sort_L_shells_dpdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63700100: sort_L_shells_dpdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 63750100: sort_L_shells_dpdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64010001: sort_L_shells_dpfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64010100: sort_L_shells_dpfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64010101: sort_L_shells_dpfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64030001: sort_L_shells_dpfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64030100: sort_L_shells_dpfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64030101: sort_L_shells_dpfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64060100: sort_L_shells_dpfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64100100: sort_L_shells_dpff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64150100: sort_L_shells_dpfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64510001: sort_L_shells_dpgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64510100: sort_L_shells_dpgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64510101: sort_L_shells_dpgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64530001: sort_L_shells_dpgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64530100: sort_L_shells_dpgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64530101: sort_L_shells_dpgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64560100: sort_L_shells_dpgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64600100: sort_L_shells_dpgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 64650100: sort_L_shells_dpgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66110001: sort_L_shells_ddss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66110010: sort_L_shells_ddss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66110011: sort_L_shells_ddss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66130001: sort_L_shells_ddsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66130010: sort_L_shells_ddsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66130011: sort_L_shells_ddsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66160010: sort_L_shells_ddsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66200010: sort_L_shells_ddsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66250010: sort_L_shells_ddsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66310001: sort_L_shells_ddps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66310010: sort_L_shells_ddps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66310011: sort_L_shells_ddps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66330001: sort_L_shells_ddpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66330010: sort_L_shells_ddpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66330011: sort_L_shells_ddpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66360010: sort_L_shells_ddpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66400010: sort_L_shells_ddpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66450010: sort_L_shells_ddpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66610001: sort_L_shells_ddds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 66630001: sort_L_shells_dddp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 67010001: sort_L_shells_ddfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 67030001: sort_L_shells_ddfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 67510001: sort_L_shells_ddgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 67530001: sort_L_shells_ddgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70110001: sort_L_shells_dfss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70110010: sort_L_shells_dfss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70110011: sort_L_shells_dfss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70130001: sort_L_shells_dfsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70130010: sort_L_shells_dfsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70130011: sort_L_shells_dfsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70160010: sort_L_shells_dfsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70200010: sort_L_shells_dfsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70250010: sort_L_shells_dfsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70310001: sort_L_shells_dfps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70310010: sort_L_shells_dfps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70310011: sort_L_shells_dfps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70330001: sort_L_shells_dfpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70330010: sort_L_shells_dfpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70330011: sort_L_shells_dfpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70360010: sort_L_shells_dfpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70400010: sort_L_shells_dfpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70450010: sort_L_shells_dfpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70610001: sort_L_shells_dfds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 70630001: sort_L_shells_dfdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 71010001: sort_L_shells_dffs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 71030001: sort_L_shells_dffp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 71510001: sort_L_shells_dfgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 71530001: sort_L_shells_dfgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75110001: sort_L_shells_dgss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75110010: sort_L_shells_dgss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75110011: sort_L_shells_dgss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75130001: sort_L_shells_dgsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75130010: sort_L_shells_dgsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75130011: sort_L_shells_dgsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75160010: sort_L_shells_dgsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75200010: sort_L_shells_dgsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75250010: sort_L_shells_dgsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75310001: sort_L_shells_dgps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75310010: sort_L_shells_dgps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75310011: sort_L_shells_dgps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75330001: sort_L_shells_dgpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75330010: sort_L_shells_dgpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75330011: sort_L_shells_dgpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75360010: sort_L_shells_dgpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75400010: sort_L_shells_dgpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75450010: sort_L_shells_dgpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75610001: sort_L_shells_dgds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 75630001: sort_L_shells_dgdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 76010001: sort_L_shells_dgfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 76030001: sort_L_shells_dgfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 76510001: sort_L_shells_dggs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 76530001: sort_L_shells_dggp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110001: sort_L_shells_fsss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110010: sort_L_shells_fsss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110011: sort_L_shells_fsss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110100: sort_L_shells_fsss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110101: sort_L_shells_fsss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110110: sort_L_shells_fsss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101110111: sort_L_shells_fsss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130001: sort_L_shells_fssp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130010: sort_L_shells_fssp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130011: sort_L_shells_fssp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130100: sort_L_shells_fssp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130101: sort_L_shells_fssp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130110: sort_L_shells_fssp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101130111: sort_L_shells_fssp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101160010: sort_L_shells_fssd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101160100: sort_L_shells_fssd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101160110: sort_L_shells_fssd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101200010: sort_L_shells_fssf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101200100: sort_L_shells_fssf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101200110: sort_L_shells_fssf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101250010: sort_L_shells_fssg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101250100: sort_L_shells_fssg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101250110: sort_L_shells_fssg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310001: sort_L_shells_fsps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310010: sort_L_shells_fsps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310011: sort_L_shells_fsps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310100: sort_L_shells_fsps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310101: sort_L_shells_fsps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310110: sort_L_shells_fsps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101310111: sort_L_shells_fsps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330001: sort_L_shells_fspp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330010: sort_L_shells_fspp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330011: sort_L_shells_fspp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330100: sort_L_shells_fspp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330101: sort_L_shells_fspp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330110: sort_L_shells_fspp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101330111: sort_L_shells_fspp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101360010: sort_L_shells_fspd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101360100: sort_L_shells_fspd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101360110: sort_L_shells_fspd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101400010: sort_L_shells_fspf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101400100: sort_L_shells_fspf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101400110: sort_L_shells_fspf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101450010: sort_L_shells_fspg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101450100: sort_L_shells_fspg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101450110: sort_L_shells_fspg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101610001: sort_L_shells_fsds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101610100: sort_L_shells_fsds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101610101: sort_L_shells_fsds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101630001: sort_L_shells_fsdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101630100: sort_L_shells_fsdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101630101: sort_L_shells_fsdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101660100: sort_L_shells_fsdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101700100: sort_L_shells_fsdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 101750100: sort_L_shells_fsdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102010001: sort_L_shells_fsfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102010100: sort_L_shells_fsfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102010101: sort_L_shells_fsfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102030001: sort_L_shells_fsfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102030100: sort_L_shells_fsfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102030101: sort_L_shells_fsfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102060100: sort_L_shells_fsfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102100100: sort_L_shells_fsff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102150100: sort_L_shells_fsfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102510001: sort_L_shells_fsgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102510100: sort_L_shells_fsgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102510101: sort_L_shells_fsgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102530001: sort_L_shells_fsgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102530100: sort_L_shells_fsgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102530101: sort_L_shells_fsgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102560100: sort_L_shells_fsgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102600100: sort_L_shells_fsgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 102650100: sort_L_shells_fsgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110001: sort_L_shells_fpss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110010: sort_L_shells_fpss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110011: sort_L_shells_fpss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110100: sort_L_shells_fpss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110101: sort_L_shells_fpss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110110: sort_L_shells_fpss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103110111: sort_L_shells_fpss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130001: sort_L_shells_fpsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130010: sort_L_shells_fpsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130011: sort_L_shells_fpsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130100: sort_L_shells_fpsp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130101: sort_L_shells_fpsp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130110: sort_L_shells_fpsp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103130111: sort_L_shells_fpsp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103160010: sort_L_shells_fpsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103160100: sort_L_shells_fpsd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103160110: sort_L_shells_fpsd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103200010: sort_L_shells_fpsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103200100: sort_L_shells_fpsf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103200110: sort_L_shells_fpsf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103250010: sort_L_shells_fpsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103250100: sort_L_shells_fpsg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103250110: sort_L_shells_fpsg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310001: sort_L_shells_fpps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310010: sort_L_shells_fpps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310011: sort_L_shells_fpps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310100: sort_L_shells_fpps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310101: sort_L_shells_fpps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310110: sort_L_shells_fpps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103310111: sort_L_shells_fpps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330001: sort_L_shells_fppp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330010: sort_L_shells_fppp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330011: sort_L_shells_fppp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330100: sort_L_shells_fppp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330101: sort_L_shells_fppp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330110: sort_L_shells_fppp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103330111: sort_L_shells_fppp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103360010: sort_L_shells_fppd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103360100: sort_L_shells_fppd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103360110: sort_L_shells_fppd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103400010: sort_L_shells_fppf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103400100: sort_L_shells_fppf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103400110: sort_L_shells_fppf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103450010: sort_L_shells_fppg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103450100: sort_L_shells_fppg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103450110: sort_L_shells_fppg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103610001: sort_L_shells_fpds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103610100: sort_L_shells_fpds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103610101: sort_L_shells_fpds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103630001: sort_L_shells_fpdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103630100: sort_L_shells_fpdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103630101: sort_L_shells_fpdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103660100: sort_L_shells_fpdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103700100: sort_L_shells_fpdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 103750100: sort_L_shells_fpdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104010001: sort_L_shells_fpfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104010100: sort_L_shells_fpfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104010101: sort_L_shells_fpfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104030001: sort_L_shells_fpfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104030100: sort_L_shells_fpfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104030101: sort_L_shells_fpfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104060100: sort_L_shells_fpfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104100100: sort_L_shells_fpff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104150100: sort_L_shells_fpfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104510001: sort_L_shells_fpgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104510100: sort_L_shells_fpgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104510101: sort_L_shells_fpgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104530001: sort_L_shells_fpgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104530100: sort_L_shells_fpgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104530101: sort_L_shells_fpgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104560100: sort_L_shells_fpgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104600100: sort_L_shells_fpgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 104650100: sort_L_shells_fpgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106110001: sort_L_shells_fdss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106110010: sort_L_shells_fdss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106110011: sort_L_shells_fdss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106130001: sort_L_shells_fdsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106130010: sort_L_shells_fdsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106130011: sort_L_shells_fdsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106160010: sort_L_shells_fdsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106200010: sort_L_shells_fdsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106250010: sort_L_shells_fdsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106310001: sort_L_shells_fdps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106310010: sort_L_shells_fdps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106310011: sort_L_shells_fdps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106330001: sort_L_shells_fdpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106330010: sort_L_shells_fdpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106330011: sort_L_shells_fdpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106360010: sort_L_shells_fdpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106400010: sort_L_shells_fdpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106450010: sort_L_shells_fdpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106610001: sort_L_shells_fdds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 106630001: sort_L_shells_fddp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 107010001: sort_L_shells_fdfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 107030001: sort_L_shells_fdfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 107510001: sort_L_shells_fdgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 107530001: sort_L_shells_fdgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110110001: sort_L_shells_ffss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110110010: sort_L_shells_ffss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110110011: sort_L_shells_ffss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110130001: sort_L_shells_ffsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110130010: sort_L_shells_ffsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110130011: sort_L_shells_ffsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110160010: sort_L_shells_ffsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110200010: sort_L_shells_ffsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110250010: sort_L_shells_ffsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110310001: sort_L_shells_ffps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110310010: sort_L_shells_ffps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110310011: sort_L_shells_ffps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110330001: sort_L_shells_ffpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110330010: sort_L_shells_ffpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110330011: sort_L_shells_ffpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110360010: sort_L_shells_ffpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110400010: sort_L_shells_ffpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110450010: sort_L_shells_ffpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110610001: sort_L_shells_ffds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 110630001: sort_L_shells_ffdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 111010001: sort_L_shells_fffs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 111030001: sort_L_shells_fffp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 111510001: sort_L_shells_ffgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 111530001: sort_L_shells_ffgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115110001: sort_L_shells_fgss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115110010: sort_L_shells_fgss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115110011: sort_L_shells_fgss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115130001: sort_L_shells_fgsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115130010: sort_L_shells_fgsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115130011: sort_L_shells_fgsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115160010: sort_L_shells_fgsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115200010: sort_L_shells_fgsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115250010: sort_L_shells_fgsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115310001: sort_L_shells_fgps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115310010: sort_L_shells_fgps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115310011: sort_L_shells_fgps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115330001: sort_L_shells_fgpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115330010: sort_L_shells_fgpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115330011: sort_L_shells_fgpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115360010: sort_L_shells_fgpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115400010: sort_L_shells_fgpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115450010: sort_L_shells_fgpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115610001: sort_L_shells_fgds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 115630001: sort_L_shells_fgdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 116010001: sort_L_shells_fgfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 116030001: sort_L_shells_fgfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 116510001: sort_L_shells_fggs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 116530001: sort_L_shells_fggp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110001: sort_L_shells_gsss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110010: sort_L_shells_gsss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110011: sort_L_shells_gsss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110100: sort_L_shells_gsss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110101: sort_L_shells_gsss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110110: sort_L_shells_gsss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151110111: sort_L_shells_gsss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130001: sort_L_shells_gssp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130010: sort_L_shells_gssp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130011: sort_L_shells_gssp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130100: sort_L_shells_gssp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130101: sort_L_shells_gssp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130110: sort_L_shells_gssp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151130111: sort_L_shells_gssp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151160010: sort_L_shells_gssd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151160100: sort_L_shells_gssd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151160110: sort_L_shells_gssd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151200010: sort_L_shells_gssf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151200100: sort_L_shells_gssf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151200110: sort_L_shells_gssf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151250010: sort_L_shells_gssg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151250100: sort_L_shells_gssg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151250110: sort_L_shells_gssg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310001: sort_L_shells_gsps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310010: sort_L_shells_gsps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310011: sort_L_shells_gsps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310100: sort_L_shells_gsps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310101: sort_L_shells_gsps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310110: sort_L_shells_gsps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151310111: sort_L_shells_gsps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330001: sort_L_shells_gspp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330010: sort_L_shells_gspp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330011: sort_L_shells_gspp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330100: sort_L_shells_gspp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330101: sort_L_shells_gspp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330110: sort_L_shells_gspp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151330111: sort_L_shells_gspp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151360010: sort_L_shells_gspd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151360100: sort_L_shells_gspd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151360110: sort_L_shells_gspd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151400010: sort_L_shells_gspf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151400100: sort_L_shells_gspf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151400110: sort_L_shells_gspf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151450010: sort_L_shells_gspg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151450100: sort_L_shells_gspg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151450110: sort_L_shells_gspg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151610001: sort_L_shells_gsds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151610100: sort_L_shells_gsds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151610101: sort_L_shells_gsds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151630001: sort_L_shells_gsdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151630100: sort_L_shells_gsdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151630101: sort_L_shells_gsdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151660100: sort_L_shells_gsdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151700100: sort_L_shells_gsdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 151750100: sort_L_shells_gsdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152010001: sort_L_shells_gsfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152010100: sort_L_shells_gsfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152010101: sort_L_shells_gsfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152030001: sort_L_shells_gsfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152030100: sort_L_shells_gsfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152030101: sort_L_shells_gsfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152060100: sort_L_shells_gsfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152100100: sort_L_shells_gsff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152150100: sort_L_shells_gsfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152510001: sort_L_shells_gsgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152510100: sort_L_shells_gsgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152510101: sort_L_shells_gsgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152530001: sort_L_shells_gsgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152530100: sort_L_shells_gsgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152530101: sort_L_shells_gsgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152560100: sort_L_shells_gsgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152600100: sort_L_shells_gsgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 152650100: sort_L_shells_gsgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110001: sort_L_shells_gpss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110010: sort_L_shells_gpss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110011: sort_L_shells_gpss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110100: sort_L_shells_gpss_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110101: sort_L_shells_gpss_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110110: sort_L_shells_gpss_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153110111: sort_L_shells_gpss_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130001: sort_L_shells_gpsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130010: sort_L_shells_gpsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130011: sort_L_shells_gpsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130100: sort_L_shells_gpsp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130101: sort_L_shells_gpsp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130110: sort_L_shells_gpsp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153130111: sort_L_shells_gpsp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153160010: sort_L_shells_gpsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153160100: sort_L_shells_gpsd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153160110: sort_L_shells_gpsd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153200010: sort_L_shells_gpsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153200100: sort_L_shells_gpsf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153200110: sort_L_shells_gpsf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153250010: sort_L_shells_gpsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153250100: sort_L_shells_gpsg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153250110: sort_L_shells_gpsg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310001: sort_L_shells_gpps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310010: sort_L_shells_gpps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310011: sort_L_shells_gpps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310100: sort_L_shells_gpps_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310101: sort_L_shells_gpps_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310110: sort_L_shells_gpps_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153310111: sort_L_shells_gpps_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330001: sort_L_shells_gppp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330010: sort_L_shells_gppp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330011: sort_L_shells_gppp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330100: sort_L_shells_gppp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330101: sort_L_shells_gppp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330110: sort_L_shells_gppp_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153330111: sort_L_shells_gppp_0111(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153360010: sort_L_shells_gppd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153360100: sort_L_shells_gppd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153360110: sort_L_shells_gppd_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153400010: sort_L_shells_gppf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153400100: sort_L_shells_gppf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153400110: sort_L_shells_gppf_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153450010: sort_L_shells_gppg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153450100: sort_L_shells_gppg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153450110: sort_L_shells_gppg_0110(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153610001: sort_L_shells_gpds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153610100: sort_L_shells_gpds_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153610101: sort_L_shells_gpds_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153630001: sort_L_shells_gpdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153630100: sort_L_shells_gpdp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153630101: sort_L_shells_gpdp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153660100: sort_L_shells_gpdd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153700100: sort_L_shells_gpdf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 153750100: sort_L_shells_gpdg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154010001: sort_L_shells_gpfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154010100: sort_L_shells_gpfs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154010101: sort_L_shells_gpfs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154030001: sort_L_shells_gpfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154030100: sort_L_shells_gpfp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154030101: sort_L_shells_gpfp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154060100: sort_L_shells_gpfd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154100100: sort_L_shells_gpff_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154150100: sort_L_shells_gpfg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154510001: sort_L_shells_gpgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154510100: sort_L_shells_gpgs_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154510101: sort_L_shells_gpgs_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154530001: sort_L_shells_gpgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154530100: sort_L_shells_gpgp_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154530101: sort_L_shells_gpgp_0101(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154560100: sort_L_shells_gpgd_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154600100: sort_L_shells_gpgf_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 154650100: sort_L_shells_gpgg_0100(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156110001: sort_L_shells_gdss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156110010: sort_L_shells_gdss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156110011: sort_L_shells_gdss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156130001: sort_L_shells_gdsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156130010: sort_L_shells_gdsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156130011: sort_L_shells_gdsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156160010: sort_L_shells_gdsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156200010: sort_L_shells_gdsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156250010: sort_L_shells_gdsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156310001: sort_L_shells_gdps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156310010: sort_L_shells_gdps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156310011: sort_L_shells_gdps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156330001: sort_L_shells_gdpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156330010: sort_L_shells_gdpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156330011: sort_L_shells_gdpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156360010: sort_L_shells_gdpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156400010: sort_L_shells_gdpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156450010: sort_L_shells_gdpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156610001: sort_L_shells_gdds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 156630001: sort_L_shells_gddp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 157010001: sort_L_shells_gdfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 157030001: sort_L_shells_gdfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 157510001: sort_L_shells_gdgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 157530001: sort_L_shells_gdgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160110001: sort_L_shells_gfss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160110010: sort_L_shells_gfss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160110011: sort_L_shells_gfss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160130001: sort_L_shells_gfsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160130010: sort_L_shells_gfsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160130011: sort_L_shells_gfsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160160010: sort_L_shells_gfsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160200010: sort_L_shells_gfsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160250010: sort_L_shells_gfsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160310001: sort_L_shells_gfps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160310010: sort_L_shells_gfps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160310011: sort_L_shells_gfps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160330001: sort_L_shells_gfpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160330010: sort_L_shells_gfpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160330011: sort_L_shells_gfpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160360010: sort_L_shells_gfpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160400010: sort_L_shells_gfpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160450010: sort_L_shells_gfpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160610001: sort_L_shells_gfds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 160630001: sort_L_shells_gfdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 161010001: sort_L_shells_gffs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 161030001: sort_L_shells_gffp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 161510001: sort_L_shells_gfgs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 161530001: sort_L_shells_gfgp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165110001: sort_L_shells_ggss_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165110010: sort_L_shells_ggss_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165110011: sort_L_shells_ggss_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165130001: sort_L_shells_ggsp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165130010: sort_L_shells_ggsp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165130011: sort_L_shells_ggsp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165160010: sort_L_shells_ggsd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165200010: sort_L_shells_ggsf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165250010: sort_L_shells_ggsg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165310001: sort_L_shells_ggps_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165310010: sort_L_shells_ggps_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165310011: sort_L_shells_ggps_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165330001: sort_L_shells_ggpp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165330010: sort_L_shells_ggpp_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165330011: sort_L_shells_ggpp_0011(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165360010: sort_L_shells_ggpd_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165400010: sort_L_shells_ggpf_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165450010: sort_L_shells_ggpg_0010(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165610001: sort_L_shells_ggds_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 165630001: sort_L_shells_ggdp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 166010001: sort_L_shells_ggfs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 166030001: sort_L_shells_ggfp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 166510001: sort_L_shells_gggs_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
        case 166530001: sort_L_shells_gggp_0001(ghondo, target, target_idx, buffer_idx, buffer_old); break;
    };
};

void sort_L_shells_ssss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 1; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssss_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sssg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,1,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssps_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sspg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,3,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssds_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssdg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,6,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssff_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssfg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,10,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ssgg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,1,15,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spss_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spsg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,1,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spps_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {1,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 27; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {1,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sppg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,3,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spds_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spdg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,6,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spff_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spfg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,10,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {1,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {1,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_spgg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,3,15,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 216; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 216; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sddg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sdgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,6,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 1000; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1000; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sffg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sfgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,10,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {1,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {1,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sgfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {1,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_sggg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {1,15,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 3375; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3375; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 1; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 1; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psss_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pssg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,1,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psps_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pspg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,3,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psds_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psdg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,6,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psff_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psfg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,10,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,1,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_psgg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,1,15,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 3; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppss_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppsg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,1,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 9; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppps_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,1};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {3,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 27; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppp_1111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,3};
    int L[4] = {1,1,1,1};
    int fullsizes[4] = {4,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppd_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,6};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppf_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,10};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {3,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pppg_1110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,3,15};
    int L[4] = {1,1,1,0};
    int fullsizes[4] = {4,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppds_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppdg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,6,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppff_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppfg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,10,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgs_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,1};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {3,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgp_1101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,3};
    int L[4] = {1,1,0,1};
    int fullsizes[4] = {4,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgd_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,6};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgf_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,10};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {3,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,3,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ppgg_1100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,3,15,15};
    int L[4] = {1,1,0,0};
    int fullsizes[4] = {4,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 6; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 18; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 54; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 108; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 216; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 216; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pddg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pdgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,6,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,6,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 10; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 30; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 100; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 300; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 1000; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1000; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pffg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pfgg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,10,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,10,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 15; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgss_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgsg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,1,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 45; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgps_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,1};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {3,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 135; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpp_1011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,3};
    int L[4] = {1,0,1,1};
    int fullsizes[4] = {4,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpd_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,6};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpf_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,10};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {3,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgpg_1010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,3,15};
    int L[4] = {1,0,1,0};
    int fullsizes[4] = {4,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgds_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 90; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgds_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 270; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 540; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 540; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgdg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,6,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 150; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 450; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgff_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 1500; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1500; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pgfg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,10,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggs_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,1};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 225; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggs_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,1};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {3,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggp_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,3};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 675; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggp_1001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,3};
    int L[4] = {1,0,0,1};
    int fullsizes[4] = {4,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggd_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,6};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 1350; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1350; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggf_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,10};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 2250; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 2250; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_pggg_1000(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {3,15,15,15};
    int L[4] = {1,0,0,0};
    int fullsizes[4] = {4,15,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 3375; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3375; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 3; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dssg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dspg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dsgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,1,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpsg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {6,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dppg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {6,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {6,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dpgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,3,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {6,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dddp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ddgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,6,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dffs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dffp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dfgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,10,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {6,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {6,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dgfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dggs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_dggp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {6,15,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {6,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 6; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fssg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fspg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fsgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,1,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpsg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {10,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fppg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {10,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {10,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fpgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,3,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {10,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fddp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fdgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,6,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fffs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fffp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ffgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,10,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {10,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {10,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fgfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fggs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_fggp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {10,15,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {10,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 10; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 1; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gssg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 4; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,1,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 27; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 16; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 48; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,1,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gspg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 6; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 54; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 72; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 108; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 10; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 120; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 100; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 300; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 15; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,1,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 135; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 180; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 270; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 150; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 450; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gsgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,1,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 1; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 0;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 225; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        prev_x = 1; for (int i = 0; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

        for (icomputed[1] = 0; icomputed[1] != 1; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 2; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 675; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 1; //stride_c*fullsizes[2];
    int stride_a = 4; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 3; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 1; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpss_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,1,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpsg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,1,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 3; //stride_c*fullsizes[2];
    int stride_a = 12; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 9; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 3; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 16; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 12; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 4; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpps_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,1};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,3,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 9; //stride_c*fullsizes[2];
    int stride_a = 36; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 27; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 9; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 48; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 36; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 12; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppp_0111(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,3};
    int L[4] = {0,1,1,1};
    int fullsizes[4] = {15,4,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 64; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 48; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 16; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppd_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,6};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppf_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,10};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,3,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,3,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gppg_0110(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,3,15};
    int L[4] = {0,1,1,0};
    int fullsizes[4] = {15,4,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpds_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 6; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 18; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 6; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpds_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 18; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 54; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 18; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 24; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 36; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 36; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 108; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 36; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpdg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,6,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,6,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 10; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 30; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 10; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 30; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 90; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 30; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 40; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpff_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 100; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 100; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 300; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 100; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpfg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,10,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,10,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgs_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,1};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 15; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 45; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 15; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgs_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,1};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,3,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgp_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,3};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 45; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 135; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 45; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgp_0101(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,3};
    int L[4] = {0,1,0,1};
    int fullsizes[4] = {15,4,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 60; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgd_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,6};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 90; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 90; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 270; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 90; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgf_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,10};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 150; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 150; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 450; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 150; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gpgg_0100(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,3,15,15};
    int L[4] = {0,1,0,0};
    int fullsizes[4] = {15,4,15,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 225; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 225; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 675; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 3; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 225; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 24; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 24; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 72; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 72; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,6,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 96; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 96; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,6,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gddp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 144; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 144; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gdgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,6,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,6,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 6; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 40; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 40; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 120; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 120; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,10,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 160; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 160; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,10,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gffs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gffp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 400; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 400; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfgs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gfgp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,10,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,10,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 10; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggss_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggss_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 1; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggss_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,1,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 9; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 4; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 12; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 6; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 18; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 10; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 30; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggsg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,1,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 2; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 15; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            prev_x = 1; for (int i = 1; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

            for (icomputed[2] = 0; icomputed[2] != 1; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 3; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 45; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggps_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggps_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,1};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,1};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 1; //stride_d*fullsizes[3];
    int stride_b = 4; //stride_c*fullsizes[2];
    int stride_a = 60; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 3; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 60; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 1; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggps_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,1};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,3,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpp_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,3};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,3};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 3; //stride_d*fullsizes[3];
    int stride_b = 12; //stride_c*fullsizes[2];
    int stride_a = 180; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 9; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 180; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 3; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpp_0011(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,3};
    int L[4] = {0,0,1,1};
    int fullsizes[4] = {15,15,4,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 16; //stride_c*fullsizes[2];
    int stride_a = 240; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 12; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 240; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 4; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpd_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,6};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,6};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 6; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 6; //sizes[3]*stride_d;
    int adjust_b = 18; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 6; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 6; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpf_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,10};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,10};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 10; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 10; //sizes[3]*stride_d;
    int adjust_b = 30; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 10; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 10; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggpg_0010(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,3,15};
    int L[4] = {0,0,1,0};
    int fullsizes[4] = {15,15,4,15};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 15; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 15; //sizes[3]*stride_d;
    int adjust_b = 45; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 3; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 15; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 0; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 15; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggds_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,6,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggdp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,6,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,6,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 24; //stride_c*fullsizes[2];
    int stride_a = 360; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 24; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 360; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 6; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggfs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,10,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_ggfp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,10,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,10,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 40; //stride_c*fullsizes[2];
    int stride_a = 600; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 40; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 600; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 10; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gggs_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,15,1};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 3; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = 2;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 1; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                prev_x = 1; for (int i = 2; i >= 0; --i) prev_x = prev_x && icomputed[i] == 0; //if previous not-s shells are on x

                for (icomputed[3] = 0; icomputed[3] != 1; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
                }
                *buffer_idx += 3; //stride_c-adjust_c
                buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (prev_x && !end_of)*(*buffer_idx) + (!prev_x || end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};

void sort_L_shells_gggp_0001(double* ghondo, double* target, int* target_idx, int* buffer_idx, int* buffer_old) {

    int sizes[4] = {15,15,15,3};
    int L[4] = {0,0,0,1};
    int fullsizes[4] = {15,15,15,4};

    *buffer_idx = *buffer_old;
    int buffer_add = *buffer_idx;

    //int s_idx = 3; while (sizes[s_idx] != 1 || !L_[s_idx]) --s_idx; //farthest-right s index associated with L shell
    int s_idx = 0; 
    //int not_s_idx = s_idx - 1; while (not_s_idx > 0 && sizes[not_s_idx] == 1) --not_s_idx; //first not-s shell to the left of s_idx
    int not_s_idx = -1;

    int stride_d = 1;
    int stride_c = 4; //stride_d*fullsizes[3];
    int stride_b = 60; //stride_c*fullsizes[2];
    int stride_a = 900; //stride_b*fullsizes[1];

    int adjust_c = 3; //sizes[3]*stride_d;
    int adjust_b = 60; //sizes[2]*(stride_c-adjust_c) + sizes[2]*adjust_c;
    int adjust_a = 900; //sizes[1]*(stride_b-adjust_b) + sizes[1]*adjust_b;

    int icomputed[4] = { 0 };
    bool prev_x = 1, end_of = 1;

    for (icomputed[0] = 0; icomputed[0] != 15; ++icomputed[0]) {
        for (icomputed[1] = 0; icomputed[1] != 15; ++icomputed[1]) {
            for (icomputed[2] = 0; icomputed[2] != 15; ++icomputed[2]) {
                for (icomputed[3] = 0; icomputed[3] != 3; ++icomputed[3], ++(*target_idx)) {
                    ghondo[*buffer_idx] = target[*target_idx];
                    *buffer_idx += 1; //stride_d

                    end_of = 1; for (int i = 1; i < 4; ++i) end_of = end_of && icomputed[i] == sizes[i]-1; //if shells after s_idx are at final shell,
                    buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
                }
                *buffer_idx += 1; //stride_c-adjust_c
                buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
            }
            *buffer_idx += 0; //stride_b-adjust_b
            buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
        }
        *buffer_idx += 0; //stride_a-adjust_a
        buffer_add = (!end_of)*(*buffer_idx) + (end_of)*buffer_add;
    }
    *buffer_old = buffer_add + 1;
};
*/
